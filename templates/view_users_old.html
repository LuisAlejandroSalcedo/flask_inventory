{% extends 'base.html' %}
{% from '_macro.html' import render_pagination %}
{% block title %}Ver Dispositivos{% endblock %}
{% block header %}
<h2>Usuarios</h2>
{% endblock %}
{% block content %}
<div class="container">
	<div class="row">
		<div class="col-md-2">
			<label>Cantidad por pagina</label>
			<select id="cant">
				<option value="1" {% if per_page == 2 %}selected="selected"{% endif %}>2</option>
				<option value="2" {% if per_page == 10 %}selected="selected"{% endif %}>10</option>
				<option value="3" {% if per_page == 50 %}selected="selected"{% endif %}>50</option>
			</select>
		</div>
		<div class="col-md-10"></div>
	</div>
    <div class="row">
		<div class="col-md-12">
		<hr>
			{% if users %}
				<table class="table table-hover">
					<thead>
						<th>Nombre</th>
						<th>E-mail</th>
						<th>Dispositivos</th>
						<th>Location</th>
						<th>Editar</th>
						<th>Borrar</th>
					</thead>
					<tbody>
						{% for user in users.items %}
							<tr>
								<td><a href="{{ url_for("view_user")}}?uid={{user.User.id}}">
								{{ user.User.username }}</a></td>
								<td>{{ user.User.email }}</td>
								<td>{% if user.User.device_assigned %}
								<ul style="list-style-type:none; margin: 0; padding: 0; overflow: hidden">
								{% for d in user.User.device_assigned %}
									<li><a href="{{ url_for("view_devices")}}?did={{d.id}}">
									{{d.name}}</a></li>
								{% endfor %}
								</ul>
								{% else %}
								Ninguno
								{% endif %}
								</td>
								<td>{{ user.location_name}}</td>
								<td>
								<a href="{{ url_for("new_user", id=user.User.id) }}">
										<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
									</a>
								</td>
								<td>
								<a href="{{ url_for("del_user", id=user.User.id) }}">
										<span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
									</a>
								</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			{% endif %}
		</div>
	</div>
	<div class="row" id="row_absolute">
		<div class="col-md-3"></div>
		<div class="col-md-6 text-center">
			
			{% if devs %}
				{{ render_pagination('view_user_old_old',pages,activo,per_page) }}
			{% endif %}
			
		</div>
		<div class="col-md-3"></div>
	</div>
</div>
{% endblock %}
{% block script %}
<script>
	$('#cant').change( function() 
	{
	var selectedValue = parseInt(jQuery(this).val());
	if(selectedValue == "1"){
	location.href="{{ url_for("view_user_old", page=1, per_page=2) }}";
	}
	if(selectedValue == "2"){
	location.href="{{ url_for("view_user_old", page=1, per_page=10) }}";
	}
	if(selectedValue == "3"){
	location.href="{{ url_for("view_user_old", page=1, per_page=50) }}";
	}
	});
</script>
{% endblock %}